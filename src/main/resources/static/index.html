<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Kino billeter</title>

    <script src="//code.jquery.com/jquery-3.4.1.js"></script>
    <script type="text/javascript">


        let ErrorX = false

        function info() {
            const velgfilm = document.getElementById("velgfilm").value;
            const antall = document.getElementById("antall").value;
            const fornavn = document.getElementById("fornavn").value;
            const etternavn = document.getElementById("etternavn").value;
            const telefonnr = document.getElementById("telefonnr").value;
            const epost = document.getElementById("epost").value;

            let filmF = velgfilm;
            let antallF = antall;
            let fornavnF = fornavn;
            let etternavnF = etternavn;
            let telefonnrF = telefonnr;
            let epostF = epost;

            if (filmF === "velg film her") {
                document.getElementById("filmX").innerHTML = "må velge film";
                ErrorX = true;
            } else if (antallF === "") {
                document.getElementById("antallX").innerHTML = "må skrive noe inn i antall";
                ErrorX = true;
            } else if (isNaN(antallF)) {
                document.getElementById("antallX").innerHTML = "må skrive noe inn riktig antall";
                ErrorX = true;
            } else if (fornavnF === "") {
                document.getElementById("fornavnX").innerHTML = "må skrive noe inn i fornavnet";
                ErrorX = true;
            } else if (etternavnF === "") {
                document.getElementById("etternavnX").innerHTML = "må skrive noe inn etternavnet";
                ErrorX = true;
            } else if (telefonnrF === "") {
                document.getElementById("telefonnrX").innerHTML = "må skrive noe inn telefonnr";
                ErrorX = true;
            } else if (isNaN(telefonnrF)) {
                document.getElementById("telefonnrX").innerHTML = "må skrive noe inn riktig telefonnr";
                ErrorX = true;
            } else if (epostF === "") {
                document.getElementById("epostX").innerHTML = "må skrive noe inn i epost";
                ErrorX = true;
            }
            if (ErrorX === true) {
                return;
            } else {
                const kinoBilleter = [];
                const billet = {
                    velgfilm: velgfilm,
                    antall: antall,
                    fornavn: fornavn,
                    etternavn: etternavn,
                    telefonnr: telefonnr,
                    epost: epost
                };
                kinoBilleter.push(billet);
                let ut = "<table><tr>" +
                    "<th><b>Film</b></th><th><b>Antall</b></th><th><b>Fornavn</b></th><th><b>Etternavn</b></th><th><b>Telefonnr</b></th><th><b>Epost</b></th>" +
                    "</tr>";
                for (let B of kinoBilleter) {
                    ut += "<tr>";
                    ut += "<td>" + B.velgfilm + "</td><td>" + B.antall + "</td><td>" + B.fornavn + "</td><td>" + B.etternavn + "</td><td>" + B.telefonnr + "</td><td>" + B.epost + "</td>";
                    ut += "</tr>";
                }
                document.getElementById("bestillingen").innerHTML = ut;

            }

            $(function() {
                $("#knapp1").click(function () {
                    $("#bestillingen").remove();
                });
            });}

        (function() { // kjøres når dokumentet er ferdig lastet
            hentAlleFilmer();
        });
        function hentAlleFilmer() {
            $.get("/hentFilmer"
                , function(filmer) {
                    formaterBiler(filmer);
                });
        }
        function formaterFilmer(filmer) {
            let ut = "<select id='valgtFilm'>";
            for(const film of filmer) {
                ut += "<option value=‘" + film.valgtfilm + "’>" + film.valgtfilm + "</option>";
            }
            ut += "</select>";
            $("#filmene").html(ut);
        }

    </script>


</head>
<body>

<h1><b>Bestlling av kinobilleter</b></h1>


<div class="form-group">
    <label>Velgfilm</label>
    <div id="filmene"></div>
</div>
 <span id="filmX" style="color:red"> </span>

</br></br>

<label for="antall"><b> Antall </b></label>

<input type="text" id="antall"/><span id="antallX" style="color:red"> </span>

</br></br>
<table>
    <tr>
        <td><b>Fornavn </b> </td><td><input type="text" id="fornavn"/></td><td><span id="fornavnX" style="color:red"> </span></td>
    </tr>
    <tr>
        <td><b>Etternavn</b> </td><td><input type="text" id="etternavn"/></td><td><span id="etternavnX" style="color:red"> </span></td>
    </tr>
    <tr>
        <td><b>Telefonnr</b> </td><td><input type="text" id="telefonnr"/></td><td><span id="telefonnrX" style="color:red"> </span></td>
    </tr>
    <tr>
        <td><b>Epost</b> </td><td><input type="text" id="epost"/></td><td><span id="epostX" style="color:red"> </span></td>
    </tr>
    <tr>
        <td><button  onclick="info();">Kjøp billet</button></td>
    </tr>
</table>

<h2><b> Alle billetter </b> </h2>
<div id="bestillingen"></div></br>

<button id="knapp1"> Slett alle billettene </button>


</body>

</body>
</html>